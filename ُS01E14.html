<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>English with Friends ‚Äî The One with the WENUS</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;1,400&family=Space+Mono:wght@400;700&family=Lato:wght@300;400;700&display=swap');

  :root {
    --cream: #FFF8EE;
    --warm: #F4ECD8;
    --brown: #3D2B1F;
    --accent: #E8542A;
    --gold: #D4A847;
    --muted: #8B7355;
    --green: #4A7C59;
    --blue: #2C5F8A;
    --purple: #6B4C8A;
    --card-bg: #FFFDF8;
    --shadow: 0 4px 24px rgba(61,43,31,0.12);
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--cream);
    font-family: 'Lato', sans-serif;
    color: var(--brown);
    min-height: 100vh;
  }

  /* HEADER */
  .header {
    background: var(--brown);
    padding: 28px 40px 24px;
    text-align: center;
    position: relative;
    overflow: hidden;
  }
  .header::before {
    content: '';
    position: absolute;
    inset: 0;
    background: repeating-linear-gradient(
      45deg, transparent, transparent 20px,
      rgba(255,255,255,0.03) 20px, rgba(255,255,255,0.03) 40px
    );
  }
  .header h1 {
    font-family: 'Playfair Display', serif;
    font-size: 2.2rem;
    color: var(--gold);
    letter-spacing: 1px;
    position: relative;
    z-index: 1;
  }
  .header h1 span { color: var(--cream); font-style: italic; }
  .header p {
    font-family: 'Space Mono', monospace;
    font-size: 0.72rem;
    color: var(--muted);
    letter-spacing: 3px;
    text-transform: uppercase;
    margin-top: 8px;
    position: relative;
    z-index: 1;
  }
  .episode-badge {
    display: inline-block;
    background: var(--accent);
    color: white;
    font-family: 'Space Mono', monospace;
    font-size: 0.65rem;
    padding: 4px 12px;
    border-radius: 20px;
    margin-top: 10px;
    letter-spacing: 2px;
    position: relative;
    z-index: 1;
  }

  /* NAV TABS */
  .tabs {
    display: flex;
    background: var(--warm);
    border-bottom: 2px solid rgba(61,43,31,0.1);
    overflow-x: auto;
    padding: 0 20px;
  }
  .tab-btn {
    flex-shrink: 0;
    padding: 14px 22px;
    border: none;
    background: none;
    font-family: 'Space Mono', monospace;
    font-size: 0.72rem;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    color: var(--muted);
    cursor: pointer;
    border-bottom: 3px solid transparent;
    margin-bottom: -2px;
    transition: all 0.2s;
  }
  .tab-btn.active {
    color: var(--accent);
    border-bottom-color: var(--accent);
  }
  .tab-btn:hover { color: var(--brown); }

  /* CONTENT */
  .content { max-width: 900px; margin: 0 auto; padding: 32px 20px; }
  .section { display: none; }
  .section.active { display: block; }

  /* VOCAB CARDS */
  .section-title {
    font-family: 'Playfair Display', serif;
    font-size: 1.6rem;
    margin-bottom: 8px;
    color: var(--brown);
  }
  .section-subtitle {
    font-size: 0.9rem;
    color: var(--muted);
    margin-bottom: 28px;
    line-height: 1.6;
  }

  .vocab-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    gap: 16px;
    margin-bottom: 40px;
  }

  .vocab-card {
    background: var(--card-bg);
    border-radius: 12px;
    box-shadow: var(--shadow);
    padding: 20px;
    cursor: pointer;
    border: 2px solid transparent;
    transition: all 0.25s;
    position: relative;
    overflow: hidden;
  }
  .vocab-card::after {
    content: 'TAP TO REVEAL';
    font-family: 'Space Mono', monospace;
    font-size: 0.6rem;
    letter-spacing: 2px;
    color: var(--muted);
    position: absolute;
    bottom: 10px;
    right: 14px;
    opacity: 0.6;
  }
  .vocab-card.revealed::after { content: 'TAP TO HIDE'; }
  .vocab-card:hover { border-color: var(--gold); transform: translateY(-2px); }
  .vocab-card .tag {
    font-family: 'Space Mono', monospace;
    font-size: 0.62rem;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    padding: 3px 8px;
    border-radius: 4px;
    margin-bottom: 10px;
    display: inline-block;
  }
  .tag-slang { background: #FFE5DC; color: var(--accent); }
  .tag-phrase { background: #E8F4EC; color: var(--green); }
  .tag-vocab { background: #E8EEFF; color: var(--blue); }
  .tag-idiom { background: #F0E8FF; color: var(--purple); }
  .tag-humor { background: #FFF3D0; color: #B8860B; }

  .vocab-word {
    font-family: 'Playfair Display', serif;
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--brown);
    margin-bottom: 4px;
  }
  .vocab-phonetic {
    font-family: 'Space Mono', monospace;
    font-size: 0.72rem;
    color: var(--muted);
    margin-bottom: 10px;
  }
  .vocab-context {
    font-size: 0.82rem;
    color: var(--muted);
    font-style: italic;
    border-left: 3px solid var(--gold);
    padding-left: 10px;
    margin-bottom: 12px;
    line-height: 1.5;
  }
  .vocab-meaning {
    display: none;
    font-size: 0.9rem;
    color: var(--brown);
    line-height: 1.6;
    background: var(--warm);
    padding: 12px;
    border-radius: 8px;
    margin-top: 10px;
  }
  .vocab-meaning .example {
    font-size: 0.82rem;
    color: var(--green);
    font-style: italic;
    margin-top: 8px;
    padding-top: 8px;
    border-top: 1px dashed rgba(0,0,0,0.1);
  }
  .vocab-card.revealed .vocab-meaning { display: block; }

  /* QUIZ SECTION */
  .quiz-container { max-width: 600px; margin: 0 auto; }
  .progress-bar-wrap {
    background: var(--warm);
    border-radius: 8px;
    height: 8px;
    margin-bottom: 30px;
    overflow: hidden;
  }
  .progress-bar {
    height: 100%;
    background: linear-gradient(90deg, var(--accent), var(--gold));
    border-radius: 8px;
    transition: width 0.4s ease;
  }
  .quiz-stats {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px;
    font-family: 'Space Mono', monospace;
    font-size: 0.72rem;
    color: var(--muted);
    letter-spacing: 1px;
  }
  .quiz-card {
    background: var(--card-bg);
    border-radius: 16px;
    box-shadow: var(--shadow);
    padding: 32px;
    margin-bottom: 20px;
    animation: fadeIn 0.3s ease;
  }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
  .quiz-type-badge {
    font-family: 'Space Mono', monospace;
    font-size: 0.65rem;
    text-transform: uppercase;
    letter-spacing: 2px;
    color: var(--muted);
    margin-bottom: 14px;
  }
  .quiz-question {
    font-family: 'Playfair Display', serif;
    font-size: 1.3rem;
    line-height: 1.5;
    margin-bottom: 8px;
    color: var(--brown);
  }
  .quiz-excerpt {
    font-style: italic;
    color: var(--muted);
    font-size: 0.85rem;
    margin-bottom: 22px;
    padding: 10px 14px;
    background: var(--warm);
    border-radius: 8px;
    border-left: 3px solid var(--gold);
    line-height: 1.6;
  }
  .quiz-options {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin-bottom: 16px;
  }
  .quiz-option {
    padding: 12px 16px;
    border: 2px solid rgba(61,43,31,0.15);
    border-radius: 10px;
    background: white;
    cursor: pointer;
    font-size: 0.9rem;
    color: var(--brown);
    text-align: left;
    transition: all 0.2s;
    line-height: 1.4;
  }
  .quiz-option:hover:not(:disabled) { border-color: var(--gold); background: var(--warm); }
  .quiz-option.correct { border-color: var(--green); background: #E8F4EC; color: var(--green); }
  .quiz-option.wrong { border-color: var(--accent); background: #FFE5DC; color: var(--accent); }
  .quiz-option:disabled { cursor: default; }

  .fill-input {
    width: 100%;
    padding: 12px 16px;
    border: 2px solid rgba(61,43,31,0.2);
    border-radius: 10px;
    font-size: 1rem;
    font-family: 'Lato', sans-serif;
    color: var(--brown);
    background: white;
    outline: none;
    margin-bottom: 12px;
    transition: border-color 0.2s;
  }
  .fill-input:focus { border-color: var(--gold); }
  .fill-input.correct { border-color: var(--green); background: #E8F4EC; }
  .fill-input.wrong { border-color: var(--accent); background: #FFE5DC; }

  .quiz-feedback {
    display: none;
    padding: 14px 18px;
    border-radius: 10px;
    font-size: 0.9rem;
    line-height: 1.5;
    margin-bottom: 16px;
  }
  .quiz-feedback.show { display: block; }
  .quiz-feedback.correct-fb { background: #E8F4EC; color: var(--green); border-left: 4px solid var(--green); }
  .quiz-feedback.wrong-fb { background: #FFE5DC; color: var(--accent); border-left: 4px solid var(--accent); }

  .btn {
    display: inline-block;
    padding: 12px 28px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    font-family: 'Space Mono', monospace;
    font-size: 0.78rem;
    letter-spacing: 1.5px;
    text-transform: uppercase;
    transition: all 0.2s;
  }
  .btn-primary { background: var(--accent); color: white; }
  .btn-primary:hover { background: #C43E1A; transform: translateY(-1px); }
  .btn-secondary { background: var(--warm); color: var(--brown); border: 2px solid rgba(61,43,31,0.2); }
  .btn-secondary:hover { background: var(--gold); color: white; }
  .btn-group { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 8px; }

  .quiz-score {
    text-align: center;
    padding: 40px;
    background: var(--card-bg);
    border-radius: 16px;
    box-shadow: var(--shadow);
  }
  .score-number {
    font-family: 'Playfair Display', serif;
    font-size: 4rem;
    color: var(--accent);
    line-height: 1;
  }
  .score-label {
    font-family: 'Space Mono', monospace;
    font-size: 0.75rem;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--muted);
    margin-top: 8px;
    margin-bottom: 20px;
  }
  .score-message {
    font-family: 'Playfair Display', serif;
    font-size: 1.3rem;
    margin-bottom: 24px;
    color: var(--brown);
    font-style: italic;
  }

  /* DIALOGUE SECTION */
  .dialogue-line {
    display: flex;
    gap: 14px;
    margin-bottom: 20px;
    align-items: flex-start;
  }
  .speaker-badge {
    flex-shrink: 0;
    width: 80px;
    text-align: center;
  }
  .speaker-name {
    font-family: 'Space Mono', monospace;
    font-size: 0.68rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    display: inline-block;
    padding: 4px 8px;
    border-radius: 4px;
    color: white;
  }
  .speaker-Monica { background: #E8542A; }
  .speaker-Chandler { background: #2C5F8A; }
  .speaker-Rachel { background: #D4A847; color: var(--brown); }
  .speaker-Joey { background: #4A7C59; }
  .speaker-Ross { background: #6B4C8A; }
  .speaker-Phoebe { background: #C45C8A; }
  .speaker-Steve { background: #556B2F; }

  .dialogue-text {
    flex: 1;
    background: var(--card-bg);
    padding: 14px 18px;
    border-radius: 10px;
    font-size: 0.92rem;
    line-height: 1.7;
    box-shadow: 0 2px 8px rgba(61,43,31,0.06);
  }
  .highlight-word {
    background: rgba(212,168,71,0.25);
    border-bottom: 2px solid var(--gold);
    cursor: pointer;
    padding: 0 2px;
    border-radius: 2px;
    position: relative;
    transition: background 0.2s;
  }
  .highlight-word:hover { background: rgba(212,168,71,0.5); }
  .tooltip {
    display: none;
    position: absolute;
    bottom: 120%;
    left: 50%;
    transform: translateX(-50%);
    background: var(--brown);
    color: var(--cream);
    padding: 10px 14px;
    border-radius: 8px;
    font-size: 0.8rem;
    width: 200px;
    line-height: 1.5;
    z-index: 100;
    box-shadow: 0 4px 16px rgba(0,0,0,0.3);
    pointer-events: none;
  }
  .tooltip::after {
    content: '';
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%);
    border: 6px solid transparent;
    border-top-color: var(--brown);
  }
  .highlight-word:hover .tooltip { display: block; }

  /* CULTURE NOTES */
  .culture-card {
    background: var(--card-bg);
    border-radius: 12px;
    box-shadow: var(--shadow);
    padding: 24px;
    margin-bottom: 20px;
    border-left: 5px solid var(--gold);
  }
  .culture-card h3 {
    font-family: 'Playfair Display', serif;
    font-size: 1.1rem;
    margin-bottom: 10px;
    color: var(--brown);
  }
  .culture-card p {
    font-size: 0.9rem;
    line-height: 1.7;
    color: #5A4030;
  }
  .culture-card .emoji { font-size: 1.4rem; margin-bottom: 8px; display: block; }

  /* FILTER BAR */
  .filter-bar { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 20px; }
  .filter-btn {
    padding: 6px 14px;
    border: 2px solid rgba(61,43,31,0.15);
    border-radius: 20px;
    background: white;
    font-size: 0.8rem;
    cursor: pointer;
    font-family: 'Space Mono', monospace;
    letter-spacing: 0.5px;
    transition: all 0.2s;
    color: var(--muted);
  }
  .filter-btn.active, .filter-btn:hover { background: var(--brown); color: var(--cream); border-color: var(--brown); }

  .hidden { display: none !important; }

  /* Responsive */
  @media (max-width: 600px) {
    .header h1 { font-size: 1.5rem; }
    .quiz-options { grid-template-columns: 1fr; }
    .dialogue-line { flex-direction: column; gap: 6px; }
    .speaker-badge { width: auto; }
  }
</style>
</head>
<body>

<div class="header">
  <h1>English with <span>Friends</span></h1>
  <p>Interactive Language Lesson</p>
  <div class="episode-badge">S01 ¬∑ The One with the WENUS ¬∑ All Vocab & Slang</div>
</div>

<div class="tabs">
  <button class="tab-btn active" onclick="showSection('vocab')">üìñ Vocab & Slang</button>
  <button class="tab-btn" onclick="showSection('dialogue')">üí¨ Annotated Script</button>
  <button class="tab-btn" onclick="showSection('quiz')">üéØ Quiz Me</button>
  <button class="tab-btn" onclick="showSection('culture')">üåé Culture Notes</button>
</div>

<div class="content">

  <!-- VOCAB SECTION -->
  <div id="vocab" class="section active">
    <h2 class="section-title">Vocabulary & Slang</h2>
    <p class="section-subtitle">Every key word, phrase, slang, and joke from this episode. Tap any card to reveal the full meaning + a new example sentence you can use yourself.</p>

    <div class="filter-bar">
      <button class="filter-btn active" onclick="filterVocab('all', this)">All</button>
      <button class="filter-btn" onclick="filterVocab('slang', this)">üî• Slang</button>
      <button class="filter-btn" onclick="filterVocab('phrase', this)">üí¨ Phrases</button>
      <button class="filter-btn" onclick="filterVocab('idiom', this)">üé≠ Idioms</button>
      <button class="filter-btn" onclick="filterVocab('vocab', this)">üìö Vocabulary</button>
      <button class="filter-btn" onclick="filterVocab('humor', this)">üòÇ Comedy</button>
    </div>

    <div class="vocab-grid" id="vocabGrid">
      <!-- Cards injected by JS -->
    </div>
  </div>

  <!-- DIALOGUE SECTION -->
  <div id="dialogue" class="section">
    <h2 class="section-title">Annotated Script</h2>
    <p class="section-subtitle">Key lines from the episode with <span style="background:rgba(212,168,71,0.3);border-bottom:2px solid #D4A847;padding:0 3px">highlighted words</span>. Hover (or tap) the highlights to see definitions instantly.</p>
    <div id="dialogueLines"></div>
  </div>

  <!-- QUIZ SECTION -->
  <div id="quiz" class="section">
    <h2 class="section-title">Quiz Yourself</h2>
    <p class="section-subtitle">Test your knowledge of every vocab item from this episode. Multiple choice, fill-in-the-blank, and more.</p>
    <div class="quiz-container" id="quizContainer"></div>
  </div>

  <!-- CULTURE NOTES -->
  <div id="culture" class="section">
    <h2 class="section-title">Culture Notes</h2>
    <p class="section-subtitle">Understanding the American culture, comedy, and references inside this episode.</p>
    <div id="cultureNotes"></div>
  </div>

</div>

<script>
// ==================== DATA ====================

const vocabData = [
  {
    word: "swizzel stick",
    phonetic: "/Ààsw…™z…ôl st…™k/",
    tag: "vocab",
    context: '"why does my swizzel stick have an eraser?"',
    meaning: "A small decorative stick used to stir cocktails or drinks. Monica finds a pencil in her coffee instead ‚Äî Rachel mixed them up.",
    example: "The bartender placed a swizzel stick in my mojito."
  },
  {
    word: "temp job",
    phonetic: "/t…õmp d í…íb/",
    tag: "phrase",
    context: '"This was supposed to be a temp job!"',
    meaning: "A temporary job ‚Äî one you plan to leave soon. Chandler took his job thinking it was short-term, but stayed 5 years without noticing.",
    example: "I took a temp job at the bookstore while I looked for something better."
  },
  {
    word: "processing supervisor",
    phonetic: "/Ààpr…ô äs…õs…™≈ã ÀåsuÀêp…ôÀàva…™z…ôr/",
    tag: "vocab",
    context: '"big Al calls me into his office and tells me he wants to make me processing supervisor"',
    meaning: "A management position overseeing data processing operations. Getting this offer should be exciting, but Chandler sees it as being 'trapped' in a career he never chose.",
    example: "After three years, she was promoted to processing supervisor."
  },
  {
    word: "WENUS",
    phonetic: "/ÀàwiÀên…ôs/",
    tag: "humor",
    context: '"I just don\'t want to be worrying about the WENUS."',
    meaning: "Weekly Estimated Net Usage Systems ‚Äî a made-up corporate acronym. The joke is that it sounds like 'Venus' or a rude word, and nobody knows what it means. It becomes funny again at the end when Chandler yells about it.",
    example: "This is pure Friends comedy ‚Äî the WENUS is a classic example of absurd corporate jargon."
  },
  {
    word: "ecclectic / eclectic",
    phonetic: "/…™Ààkl…õkt…™k/",
    tag: "vocab",
    context: '"he wants to do some eclectic"',
    meaning: "Selecting or using elements from a variety of sources or styles. When describing food, it means mixing cuisines or styles creatively.",
    example: "The restaurant had an eclectic menu ‚Äî Thai, Italian, and Mexican all in one place."
  },
  {
    word: "career counselor",
    phonetic: "/k…ôÀàr…™…ôr Ààka äns…ôl…ôr/",
    tag: "vocab",
    context: '"I have an appointment to see Dr. Robert Pillman, career counselor a-gogo"',
    meaning: "A professional who helps people figure out what work they want to do. Chandler adds 'a-gogo' humorously ‚Äî it's a suffix meaning 'in abundance' or used to make things sound fun/ridiculous.",
    example: "She visited a career counselor after graduating and couldn't decide what to do."
  },
  {
    word: "a-gogo",
    phonetic: "/…ôÀà…°…ô ä…°…ô ä/",
    tag: "humor",
    context: '"career counselor a-gogo... I added the a-gogo"',
    meaning: "A playful suffix, originally from French, meaning 'in abundance' or 'galore.' Used in club names (Whisky a Go Go) or sarcastically to make something sound hilariously grander than it is.",
    example: "He called it a 'job fair a-gogo' ‚Äî there were booths everywhere."
  },
  {
    word: "the lesser-known 'I don't have a dream' speech",
    phonetic: "",
    tag: "humor",
    context: '"Ah, the lesser-known I don\'t have a dream speech."',
    meaning: "A joke by Ross. It refers to Martin Luther King Jr.'s famous 'I Have a Dream' speech. Ross sarcastically calls Chandler's negative version the 'lesser-known' one.",
    example: "Cultural reference humor: knowing the original makes the joke much funnier."
  },
  {
    word: "audition",
    phonetic: "/…îÀêÀàd…™ É…ôn/",
    tag: "vocab",
    context: '"I\'m cooking dinner for him Monday night ‚Äî kind of like an audition"',
    meaning: "A trial performance to demonstrate your skills. Here Monica uses it metaphorically ‚Äî her dinner IS her job interview.",
    example: "The chef cooked a tasting menu as her audition for the head chef position."
  },
  {
    word: "amuse-bouche",
    phonetic: "/√¶ÀåmjuÀêz ÀàbuÀê É/",
    tag: "vocab",
    context: '"The French call it an amuse-bouche."',
    meaning: "French culinary term: a tiny, one-bite appetizer served before a meal to 'amuse the mouth.' Chandler makes a pun: 'It is amouz-ing' (amusing).",
    example: "The fine dining restaurant served an amuse-bouche of foie gras on a tiny spoon."
  },
  {
    word: "professional vs amateur",
    phonetic: "",
    tag: "idiom",
    context: '"I\'ve sort of been maintaining my amateur status so I can waitress in the Olympics"',
    meaning: "Rachel sarcastically uses sports terminology (amateur status in the Olympics) to mock Monica calling Wendy a 'professional' waitress, implying Rachel is not. Sharp, witty sarcasm.",
    example: "Understanding this joke requires knowing that 'amateur status' is an Olympic sports concept."
  },
  {
    word: "blazed up a doobie",
    phonetic: "/ble…™zd  åp …ô ÀàduÀêbi/",
    tag: "slang",
    context: '"In the cab, on the way over, Steve blazed up a doobie."',
    meaning: "Slang: smoked a marijuana cigarette. 'Blazed up' = lit/smoked. 'Doobie' = a rolled marijuana cigarette. Very 1990s American slang.",
    example: "‚ö†Ô∏è This is informal/slang vocabulary. You'd recognize it in TV/movies or informal speech."
  },
  {
    word: "smoked a joint / lit a bone",
    phonetic: "",
    tag: "slang",
    context: '"Smoked a joint? You know, lit a bone? Weed? Hemp? Ganja?"',
    meaning: "Phoebe lists many slang terms for smoking marijuana. 'Joint' and 'bone' = rolled cigarette. 'Weed,' 'hemp,' 'ganja' = the substance itself. Ganja comes from Hindi/Jamaican English.",
    example: "These are all recognized slang terms. Phoebe's list is funny because she keeps escalating."
  },
  {
    word: "I'm with you, Cheech",
    phonetic: "/t ÉiÀêt É/",
    tag: "humor",
    context: '"OK, OK. I\'m with you, Cheech."',
    meaning: "'Cheech' refers to Cheech Marin of the famous comedy duo 'Cheech & Chong,' known for marijuana-themed humor. Rachel calls Phoebe 'Cheech' because she's explaining so many drug slang terms.",
    example: "This is a pop culture reference ‚Äî knowing Cheech & Chong makes the joke land."
  },
  {
    word: "tool (as insult)",
    phonetic: "/tuÀêl/",
    tag: "slang",
    context: '"What a tool!"',
    meaning: "American slang insult: a person who acts stupid, is easily manipulated, or behaves in a foolish/annoying way. Joey uses it to describe Steve after his stoned behavior ruined Monica's dinner.",
    example: "Don't listen to him ‚Äî he's a total tool who always shows up late and ruins everything."
  },
  {
    word: "James Michener of dirty talk",
    phonetic: "/Ààd íe…™mz Ààm…™t É…ôn…ôr/",
    tag: "humor",
    context: '"I was the James Michener of dirty talk."',
    meaning: "James Michener was a famous American author known for extremely long, detailed novels with multiple characters, plotlines, and historical scope. Ross saying this means his 'dirty talk' was so elaborate it was like a Michener novel ‚Äî with villagers, themes, motifs. Pure absurdist humor.",
    example: "Cultural reference: the funnier because it's such an unexpected comparison."
  },
  {
    word: "dirty talk",
    phonetic: "/Ààd…úÀêti t…îÀêk/",
    tag: "phrase",
    context: '"She took me by surprise ‚Äî she wanted me to talk dirty."',
    meaning: "Saying sexually suggestive or explicit things to a partner. Ross is completely unable to do this naturally, which is a running joke.",
    example: "This is common English phrase ‚Äî you'll encounter it frequently in TV and movies."
  },
  {
    word: "vulva",
    phonetic: "/Ààv ålv…ô/",
    tag: "humor",
    context: '"Ross: um... vulva."',
    meaning: "The medical/anatomical term for female genitals. Ross panics and blurts out a clinical term instead of something sexy ‚Äî this is the whole joke. It's 100% clinical, not romantic at all.",
    example: "The comedy works because of the contrast between what's expected and what Ross says."
  },
  {
    word: "cuddling",
    phonetic: "/Ààk ådl…™≈ã/",
    tag: "vocab",
    context: '"we ended up cuddling... which was nice."',
    meaning: "Holding someone close in a warm, affectionate way ‚Äî hugging while lying together. Joey mocks Ross for this because it means nothing romantic happened.",
    example: "After the movie, they sat on the couch cuddling."
  },
  {
    word: "rooting for",
    phonetic: "/ÀàruÀêt…™≈ã f…îÀê/",
    tag: "phrase",
    context: '"I was always rooting for you two kids to get together."',
    meaning: "To support or cheer for someone. Chandler sarcastically says he was 'rooting for' Ross and Joey to become a couple, after catching them doing dirty talk practice.",
    example: "I've always been rooting for the underdog team to win."
  },
  {
    word: "play hardball",
    phonetic: "/ple…™ Ààh…ëÀêdb…îÀêl/",
    tag: "idiom",
    context: '"I\'m not playing hardball here, OK? This is not a negotiation, this is a rejection!"',
    meaning: "To negotiate or deal with someone in an aggressive, uncompromising way ‚Äî using maximum pressure to get what you want. Chandler insists he's NOT doing this, but the irony is he accidentally negotiates himself back into the job.",
    example: "The union decided to play hardball and refused to settle for anything less than a 15% raise."
  },
  {
    word: "I'll see you on Monday",
    phonetic: "",
    tag: "humor",
    context: '"No! Stop saying numbers! I\'m telling you, you\'ve got the wrong guy! I\'ll see you on Monday!"',
    meaning: "The comedic payoff: Chandler spends the whole episode insisting he quit, then accidentally agrees to go back because the money was too good. He realizes mid-sentence he's been manipulated.",
    example: "The humor: watch how his 'no' slowly becomes 'yes' as the boss keeps raising the salary."
  },
  {
    word: "chick magnet",
    phonetic: "/t É…™k Ààm√¶…°n…™t/",
    tag: "slang",
    context: '"That monkey is a chick magnet!"',
    meaning: "Informal/slang: something (or someone) that attracts women. 'Chick' is informal (slightly dated) slang for a woman or girl. Joey claims Marcel the monkey will attract women to Ross.",
    example: "He brought his puppy to the park ‚Äî puppies are total chick magnets."
  },
  {
    word: "seal the deal",
    phonetic: "/siÀêl √∞…ô diÀêl/",
    tag: "idiom",
    context: '"She\'ll take one look at his furry little face and it\'ll seal the deal."',
    meaning: "To finalize or guarantee a successful outcome. Joey means the monkey will guarantee Ross and Celia becoming a couple. Originally a business term, now used widely.",
    example: "The free dessert sealed the deal ‚Äî the customer definitely left a good review."
  },
  {
    word: "aptitude test",
    phonetic: "/Àà√¶pt…™tjuÀêd t…õst/",
    tag: "vocab",
    context: '"Eight and a half hours of aptitude tests, intelligence tests, personality tests..."',
    meaning: "A test designed to measure your natural ability or talent in specific areas ‚Äî used to suggest what career you're suited for. The joke: after all that, Chandler is told he should do exactly what he already does.",
    example: "Many companies use aptitude tests as part of their hiring process."
  },
  {
    word: "ideally suited for",
    phonetic: "/a…™Ààd…™…ôli ÀàsuÀêt…™d f…îÀê/",
    tag: "phrase",
    context: '"You are ideally suited for a career in data processing."',
    meaning: "Perfectly matched or qualified for something. This is the devastating punch line ‚Äî the career test confirms Chandler's worst fear: he's made for the job he hates.",
    example: "With your language skills, you're ideally suited for a career in international business."
  },
  {
    word: "slap my ass and call me Judy",
    phonetic: "",
    tag: "slang",
    context: '"Well, slap my ass and call me Judy! These are fantastic!"',
    meaning: "A comedic, exaggerated exclamation of surprise or delight. This is absurdist American slang ‚Äî used for comic effect, not literally. Means roughly: 'Wow, I'm completely shocked/amazed!'",
    example: "This is character comedy ‚Äî it perfectly shows Steve is stoned and using bizarre expressions."
  },
  {
    word: "tartlets",
    phonetic: "/Ààt…ëÀêtl…™ts/",
    tag: "humor",
    context: '"Tartlets. Tartlets. Tartlets. The word has lost all meaning."',
    meaning: "Small tarts (pastry shells with filling). The joke is a classic stoner trope: repeating a word until it sounds meaningless (semantic satiation). Shows how high Steve is.",
    example: "Semantic satiation: repeat any word enough times and it starts to sound strange."
  },
  {
    word: "Gummi Bears",
    phonetic: "/Àà…° åmi b…õÀêz/",
    tag: "vocab",
    context: '"Give me the Gummi-bears. ‚Äî No."',
    meaning: "A popular chewy candy shaped like small bears, made by Haribo (German brand). Steve's obsession with snacks (Gummi Bears, Sugar-O's, macaroni) while at a gourmet dinner is entirely because he's high.",
    example: "He grabbed a bag of Gummi Bears at the checkout and ate them all before leaving the store."
  },
  {
    word: "Little corn envelope",
    phonetic: "",
    tag: "humor",
    context: '"Taco shells... They\'re like a little corn envelope."',
    meaning: "Steve, stoned, describes taco shells as 'corn envelopes' because he can't remember the word. This is funny because it's weirdly logical but completely wrong. Shows how marijuana affects language.",
    example: "Comedy technique: showing character in altered state through their word choices."
  },
  {
    word: "Man overboard",
    phonetic: "/m√¶n Àà…ô äv…ôb…îÀêd/",
    tag: "phrase",
    context: '"Man overboard! I think he\'s drowning."',
    meaning: "A nautical emergency cry when someone falls off a ship. Steve throws Gummi Bears into the punch bowl and pretends they're drowning sailors ‚Äî pure stoned imagination running wild.",
    example: "'Man overboard!' the sailor shouted as the passenger fell into the sea."
  },
  {
    word: "I wasn't faking",
    phonetic: "",
    tag: "phrase",
    context: '"You know all those yummy noises? I wasn\'t faking."',
    meaning: "Phoebe reassures Monica that her enthusiastic food reactions were real, not performed. 'Faking' = pretending. This is a gentle, sweet moment after a hard evening for Monica.",
    example: "I said I loved the cake and I wasn't faking ‚Äî it was genuinely incredible."
  },
  {
    word: "Whoaaaaa",
    phonetic: "/w…ô ä/",
    tag: "slang",
    context: '"Whooooaaaa..." (Chandler at end, realizing he\'s back at work)',
    meaning: "An exclamation of realization, shock, or being stunned. The final scene: Chandler screams at his employee about the WENUS, then has a moment of self-awareness ‚Äî he's become exactly what he feared.",
    example: "The ending is the emotional payoff of the whole episode: 'He became the WENUS guy.'"
  },
];

// ==================== DIALOGUE ====================
const dialogueData = [
  {
    speaker: "Monica",
    text: `why does my <span class="highlight-word">swizzel stick<span class="tooltip">A cocktail stirrer. She finds a pencil in her drink instead ‚Äî Rachel mixed them up.</span></span> have an eraser?`
  },
  {
    speaker: "Chandler",
    text: `Big Al calls me into his office and tells me he wants to make me <span class="highlight-word">processing supervisor<span class="tooltip">A management role overseeing data systems. A big promotion ‚Äî but Chandler doesn't want it.</span></span>. So... I <span class="highlight-word">quit<span class="tooltip">To leave a job voluntarily. Chandler's big, impulsive decision that drives the whole episode.</span></span>.`
  },
  {
    speaker: "Chandler",
    text: `This was supposed to be a <span class="highlight-word">temp job<span class="tooltip">Temporary job ‚Äî planned to be short. He's been there 5 years without noticing.</span></span>! If I took this promotion, it'd be like admitting that this is what I actually do.`
  },
  {
    speaker: "Chandler",
    text: `I just don't want to be one of those guys that's in his office until twelve o'clock at night worrying about the <span class="highlight-word">WENUS<span class="tooltip">Weekly Estimated Net Usage Systems. Made-up corporate acronym. Sounds funny. Becomes the episode's ironic punchline.</span></span>.`
  },
  {
    speaker: "Rachel",
    text: `<span class="highlight-word">Oh. That WENUS.<span class="tooltip">Sarcastic deadpan. She pretends she knew what WENUS was all along. Classic Rachel humor.</span></span>`
  },
  {
    speaker: "Chandler",
    text: `I have an appointment to see Dr. Robert Pillman, <span class="highlight-word">career counselor<span class="tooltip">A professional who helps you find the right career path.</span></span> <span class="highlight-word">a-gogo<span class="tooltip">Playful suffix meaning 'galore' or 'to the max.' Chandler added it himself to be funny.</span></span>. I added the 'a-gogo'.`
  },
  {
    speaker: "Ross",
    text: `Ah, the lesser-known <span class="highlight-word">'I don't have a dream' speech<span class="tooltip">Reference to MLK's "I Have a Dream." Ross jokes that Chandler's negative version is the obscure, unpopular counterpart.</span></span>.`
  },
  {
    speaker: "Monica",
    text: `I'm cooking dinner for him Monday night. Kind of like an <span class="highlight-word">audition<span class="tooltip">A trial performance. Monica means this dinner IS her job interview ‚Äî she must impress Steve with her cooking.</span></span>.`
  },
  {
    speaker: "Monica",
    text: `It's supposed to be that small. It's a pre-appetizer. The French call it an <span class="highlight-word">amuse-bouche<span class="tooltip">French: 'amuse the mouth.' A tiny one-bite course before the meal. Very fancy French cuisine term.</span></span>.`
  },
  {
    speaker: "Rachel",
    text: `Oh! I see. And I've sort of been <span class="highlight-word">maintaining my amateur status<span class="tooltip">Olympic sports term: amateurs can't be paid. Rachel sarcastically uses this to mock being called 'unprofessional.'</span></span> so that I can waitress in the Olympics.`
  },
  {
    speaker: "Phoebe",
    text: `In the cab, on the way over, Steve <span class="highlight-word">blazed up a doobie<span class="tooltip">Slang: smoked marijuana. 'Blazed up' = lit it. 'Doobie' = rolled joint. 1990s American slang.</span></span>.`
  },
  {
    speaker: "Rachel",
    text: `OK, OK. I'm with you, <span class="highlight-word">Cheech<span class="tooltip">Refers to Cheech Marin (Cheech & Chong) ‚Äî a famous comedy duo known for drug humor. Rachel says this because Phoebe is listing marijuana slang.</span></span>.`
  },
  {
    speaker: "Joey",
    text: `That monkey is a <span class="highlight-word">chick magnet<span class="tooltip">Slang: something that attracts women. Joey thinks the monkey will help Ross with his date.</span></span>! She's going to take one look at his furry, cute little face and it'll <span class="highlight-word">seal the deal<span class="tooltip">Idiom: to finalize a successful outcome. Originally business language, now everyday.</span></span>.`
  },
  {
    speaker: "Steve",
    text: `Well, <span class="highlight-word">slap my ass and call me Judy<span class="tooltip">Absurdist exclamation of amazement. Not literal ‚Äî just Steve's stoned, over-the-top way of saying 'WOW, these are incredible!'</span></span>! These are fantastic!`
  },
  {
    speaker: "Steve",
    text: `<span class="highlight-word">Tartlets. Tartlets. Tartlets.<span class="tooltip">Semantic satiation: repeating a word until it loses meaning. Classic stoned behavior ‚Äî and a famous Friends comedy moment.</span></span> The word has lost all meaning.`
  },
  {
    speaker: "Steve",
    text: `Taco shells! They're like a little <span class="highlight-word">corn envelope<span class="tooltip">Steve can't remember 'taco shell' so he invents a description. Logically correct but completely wrong ‚Äî shows his stoned state.</span></span>.`
  },
  {
    speaker: "Joey",
    text: `What a <span class="highlight-word">tool<span class="tooltip">American slang insult: a foolish, annoying, or easily-used person. Joey uses it to describe Steve after the ruined dinner.</span></span>!`
  },
  {
    speaker: "Ross",
    text: `I was the <span class="highlight-word">James Michener<span class="tooltip">Famous US author known for enormous, detailed novels with many characters & plotlines. Ross means his 'dirty talk' was epically long and elaborate ‚Äî absurd self-praise.</span></span> of dirty talk. There were different characters, plot lines, themes, a motif... at one point there were <span class="highlight-word">villagers<span class="tooltip">The funniest word in the speech ‚Äî completely out of place in a romantic context. Shows how Ross overthinks everything.</span></span>.`
  },
  {
    speaker: "Chandler",
    text: `I'm not <span class="highlight-word">playing hardball<span class="tooltip">Idiom: negotiating aggressively. Chandler insists he's not negotiating ‚Äî but he accidentally keeps negotiating.</span></span> here, OK? This is not a negotiation, this is a <span class="highlight-word">rejection<span class="tooltip">A firm 'no.' But then: 'I'll see you on Monday!' ‚Äî the joke is he fails at his own rejection.</span></span>! ... I'll see you on Monday.`
  },
  {
    speaker: "Chandler",
    text: `[staring at the phone] <span class="highlight-word">Whoooaaaa...<span class="tooltip">The perfect comedic ending: Chandler realizes he has become the WENUS guy he feared. One sound, no words needed.</span></span>`
  },
];

// ==================== QUIZ ====================
const quizData = [
  {
    type: "multiple",
    question: "What does 'a temp job' mean?",
    excerpt: '"This was supposed to be a temp job!"',
    options: ["A high-paying job", "A temporary job you plan to leave", "A job at a temperature plant", "A boring, repetitive job"],
    answer: 1,
    explanation: "Temp = temporary. Chandler took the job thinking it was short-term, but accidentally stayed 5 years."
  },
  {
    type: "multiple",
    question: "What does 'WENUS' stand for?",
    excerpt: '"I just don\'t want to be worrying about the WENUS."',
    options: ["A planet", "Weekly Estimated Net Usage Systems", "Work Evaluation and Numbering Unit System", "Chandler never says"],
    answer: 1,
    explanation: "Weekly Estimated Net Usage Systems ‚Äî completely made up corporate jargon that Chandler hates."
  },
  {
    type: "multiple",
    question: "What does 'blazed up a doobie' mean?",
    excerpt: '"In the cab, on the way over, Steve blazed up a doobie."',
    options: ["He made a phone call", "He smoked marijuana", "He lit a cigar", "He fell asleep"],
    answer: 1,
    explanation: "'Blazed up' = lit and smoked. 'Doobie' = a rolled marijuana cigarette. 1990s slang Phoebe uses."
  },
  {
    type: "multiple",
    question: "Why does Rachel call Phoebe 'Cheech'?",
    excerpt: '"OK, OK. I\'m with you, Cheech."',
    options: ["It's Phoebe's nickname", "Cheech Marin is famous for drug comedy, and Phoebe is listing drug slang", "Cheech is a French term for gossip", "Rachel is confused"],
    answer: 1,
    explanation: "Cheech Marin of Cheech & Chong is an iconic drug-comedy reference. Rachel calls Phoebe this because she lists so many marijuana terms."
  },
  {
    type: "fill",
    question: "Fill in the blank: 'She'll take one look at Marcel and it'll _____ _____ _____.'",
    excerpt: '"That monkey is a chick magnet! She\'s going to take one look at his furry little face and it\'ll _____ _____ _____."',
    answer: "seal the deal",
    explanation: "'Seal the deal' = to finalize a successful outcome. Joey means the monkey guarantees Ross gets the girl."
  },
  {
    type: "multiple",
    question: "What is an 'amuse-bouche'?",
    excerpt: '"The French call it an amuse-bouche."',
    options: ["A French insult", "A tiny one-bite appetizer before a meal", "A type of bread", "A cooking technique"],
    answer: 1,
    explanation: "French: 'amuse the mouth.' A tiny culinary introduction ‚Äî very fancy. Chandler puns: 'It is amouz-ing.'"
  },
  {
    type: "multiple",
    question: "What does 'playing hardball' mean?",
    excerpt: '"I\'m not playing hardball here ‚Äî this is not a negotiation, this is a rejection!"',
    options: ["Playing baseball seriously", "Negotiating in a tough, uncompromising way", "Refusing to talk at all", "Being physically aggressive"],
    answer: 1,
    explanation: "To play hardball = to negotiate aggressively. The irony: while saying he's NOT negotiating, Chandler IS negotiating."
  },
  {
    type: "multiple",
    question: "Why does Ross say 'vulva' to Celia?",
    excerpt: '"Say something hot... Ross: um... vulva."',
    options: ["He's a scientist and uses clinical terms", "He panics and blurts out the only word he can think of", "He thinks it sounds romantic", "It's a foreign language word"],
    answer: 1,
    explanation: "Ross panics when asked for 'dirty talk' and blurts a clinical anatomical term. The comedy is the contrast between what's expected (something sexy) and what he says (something medical)."
  },
  {
    type: "fill",
    question: "Complete: 'That monkey is a total _____ _____!'",
    excerpt: '"That monkey is a total _____ _____! She\'s going to love him."',
    answer: "chick magnet",
    explanation: "'Chick magnet' = something that attracts women. 'Chick' is informal/slightly dated slang for a woman."
  },
  {
    type: "multiple",
    question: "What is 'semantic satiation' as shown in the episode?",
    excerpt: '"Tartlets. Tartlets. Tartlets. The word has lost all meaning."',
    options: ["Getting full from tarts", "Repeating a word until it sounds meaningless", "A type of eating disorder", "French cooking philosophy"],
    answer: 1,
    explanation: "Semantic satiation = when you repeat a word so many times it stops making sense. Steve does this with 'tartlets' ‚Äî a classic stoned moment."
  },
  {
    type: "multiple",
    question: "What does Joey mean when he calls Steve 'a tool'?",
    excerpt: '"What a tool!"',
    options: ["Steve is useful to have around", "Steve is a carpenter", "Steve is a foolish, annoying person", "Steve is very clever"],
    answer: 2,
    explanation: "'Tool' as an insult = a stupid, annoying, or easily manipulated person. Joey uses it because Steve ruined Monica's big dinner opportunity."
  },
  {
    type: "multiple",
    question: "When Ross says he was 'the James Michener of dirty talk,' what does he mean?",
    excerpt: '"I was the James Michener of dirty talk ‚Äî different characters, plot lines, themes, a motif... at one point there were villagers."',
    options: ["He talked very quietly", "He talked for a very long time with elaborate detail", "He used romantic language", "He spoke in French"],
    answer: 1,
    explanation: "James Michener wrote famously long, detailed novels. Ross's dirty talk was epically over-complicated ‚Äî hence 'villagers.' Absurdist comedy."
  },
];

// ==================== CULTURE NOTES ====================
const cultureData = [
  {
    emoji: "üé§",
    title: "Martin Luther King Jr. ‚Äî 'I Have a Dream'",
    text: "One of the most famous speeches in American history (1963). Ross's joke 'the lesser-known I don't have a dream speech' only works if you know the original. This type of reference humor is very common in American TV comedy ‚Äî knowing the reference makes you 'in' on the joke."
  },
  {
    emoji: "üçÅ",
    title: "Cheech & Chong ‚Äî Drug Comedy",
    text: "Cheech Marin and Tommy Chong were a wildly popular comedy duo in the 1970s-80s known for marijuana-themed humor. By 1994 when Friends aired, they were cultural icons. Rachel calling Phoebe 'Cheech' is a quick, smart pop culture shorthand ‚Äî one word communicates a whole concept."
  },
  {
    emoji: "üìö",
    title: "James Michener ‚Äî The Long Novel",
    text: "James Michener (1907-1997) wrote enormously long novels like 'Hawaii,' 'Centennial,' and 'The Source' ‚Äî often 1,000+ pages with vast casts of characters, multiple generations, historical scope, and strong 'motifs.' Ross applying this to dirty talk is absurdist comedy at its finest."
  },
  {
    emoji: "üè¢",
    title: "Corporate America ‚Äî The 'Golden Handcuffs' Trap",
    text: "Chandler's story is very relatable to American workers: you take a 'temporary' job, get comfortable, and suddenly years pass. The 'golden handcuffs' is an expression for when salary is so good you can't leave even if you hate the job. The WENUS ending shows Chandler has fully transformed ‚Äî he's become what he feared."
  },
  {
    emoji: "üçΩÔ∏è",
    title: "Fine Dining Culture ‚Äî Amuse-Bouche",
    text: "In the 1990s, French fine dining terms were becoming trendy in American restaurants. 'Amuse-bouche,' 'tasting menu,' 'eclectic cuisine' ‚Äî Monica uses these terms to show she's a serious professional chef. Chandler's pun ('it is amouz-ing') gently mocks the pretension."
  },
  {
    emoji: "üé≠",
    title: "The Stoner Comedy Trope",
    text: "Steve's behavior follows classic comedy writing about marijuana: craving junk food (munchies), becoming paranoid/confused, word-finding problems ('little corn envelope'), fixating on objects, losing track of time. Friends plays this for comedy but also uses it to create obstacles for Monica ‚Äî showing how random bad luck can destroy big opportunities."
  },
  {
    emoji: "üêí",
    title: "Dirty Talk Practice Scene",
    text: "The scene where Ross practices dirty talk with Joey (with Chandler watching) is a masterclass in situational comedy. It works on multiple levels: Ross's clinical awkwardness, Joey's surprising competence, and the perfectly timed interruption. Notice how the comedy escalates ‚Äî each line funnier than the last."
  },
  {
    emoji: "üá∫üá∏",
    title: "'Temp job' Culture in 1990s New York",
    text: "In the early 1990s, many young people in New York did 'temp work' while pursuing creative careers. Chandler is the comic embodiment of someone who accidentally fell into corporate life. His story resonates because it's universal ‚Äî the gap between who we think we'll be and who we actually become."
  },
];

// ==================== RENDER FUNCTIONS ====================

function renderVocab() {
  const grid = document.getElementById('vocabGrid');
  grid.innerHTML = vocabData.map((v, i) => `
    <div class="vocab-card" data-tag="${v.tag}" onclick="toggleCard(this)">
      <div class="tag tag-${v.tag}">${{slang:'üî• Slang', phrase:'üí¨ Phrase', vocab:'üìö Vocab', idiom:'üé≠ Idiom', humor:'üòÇ Comedy'}[v.tag]}</div>
      <div class="vocab-word">${v.word}</div>
      ${v.phonetic ? `<div class="vocab-phonetic">${v.phonetic}</div>` : ''}
      <div class="vocab-context">"${v.context}"</div>
      <div class="vocab-meaning">
        ${v.meaning}
        <div class="example">üí° ${v.example}</div>
      </div>
    </div>
  `).join('');
}

function toggleCard(card) {
  card.classList.toggle('revealed');
}

function filterVocab(tag, btn) {
  document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  document.querySelectorAll('.vocab-card').forEach(card => {
    if (tag === 'all' || card.dataset.tag === tag) {
      card.classList.remove('hidden');
    } else {
      card.classList.add('hidden');
    }
  });
}

function renderDialogue() {
  const container = document.getElementById('dialogueLines');
  container.innerHTML = dialogueData.map(line => `
    <div class="dialogue-line">
      <div class="speaker-badge">
        <span class="speaker-name speaker-${line.speaker}">${line.speaker}</span>
      </div>
      <div class="dialogue-text">${line.text}</div>
    </div>
  `).join('');
}

function renderCulture() {
  const container = document.getElementById('cultureNotes');
  container.innerHTML = cultureData.map(c => `
    <div class="culture-card">
      <span class="emoji">${c.emoji}</span>
      <h3>${c.title}</h3>
      <p>${c.text}</p>
    </div>
  `).join('');
}

// ==================== QUIZ ENGINE ====================
let quizState = { current: 0, score: 0, answered: false, questions: [] };

function shuffleArray(arr) {
  return [...arr].sort(() => Math.random() - 0.5);
}

function startQuiz() {
  quizState = {
    current: 0,
    score: 0,
    answered: false,
    questions: shuffleArray(quizData)
  };
  renderCurrentQuestion();
}

function renderCurrentQuestion() {
  const container = document.getElementById('quizContainer');
  const { questions, current } = quizState;
  const total = questions.length;

  if (current >= total) {
    renderQuizScore();
    return;
  }

  const q = questions[current];
  const progress = (current / total) * 100;

  let questionHTML = '';
  if (q.type === 'multiple') {
    questionHTML = `
      <div class="quiz-options" id="quizOptions">
        ${q.options.map((opt, i) => `
          <button class="quiz-option" onclick="checkMultiple(${i})">${opt}</button>
        `).join('')}
      </div>
    `;
  } else if (q.type === 'fill') {
    questionHTML = `
      <input type="text" class="fill-input" id="fillInput" placeholder="Type your answer..." onkeydown="if(event.key==='Enter') checkFill()">
      <div class="btn-group">
        <button class="btn btn-primary" onclick="checkFill()">Check Answer</button>
      </div>
    `;
  }

  container.innerHTML = `
    <div class="quiz-stats">
      <span>Question ${current + 1} of ${total}</span>
      <span>Score: ${quizState.score}</span>
    </div>
    <div class="progress-bar-wrap">
      <div class="progress-bar" style="width:${progress}%"></div>
    </div>
    <div class="quiz-card">
      <div class="quiz-type-badge">${q.type === 'fill' ? '‚úèÔ∏è Fill in the blank' : 'üîò Multiple choice'}</div>
      <div class="quiz-question">${q.question}</div>
      <div class="quiz-excerpt">${q.excerpt}</div>
      ${questionHTML}
      <div class="quiz-feedback" id="quizFeedback"></div>
      <div id="nextBtnArea"></div>
    </div>
  `;
}

function checkMultiple(selected) {
  if (quizState.answered) return;
  quizState.answered = true;
  const q = quizState.questions[quizState.current];
  const options = document.querySelectorAll('.quiz-option');
  options.forEach(b => b.disabled = true);
  options[q.answer].classList.add('correct');
  const feedback = document.getElementById('quizFeedback');

  if (selected === q.answer) {
    quizState.score++;
    feedback.className = 'quiz-feedback show correct-fb';
    feedback.textContent = '‚úÖ Correct! ' + q.explanation;
    options[selected].classList.add('correct');
  } else {
    feedback.className = 'quiz-feedback show wrong-fb';
    feedback.textContent = '‚ùå Not quite. ' + q.explanation;
    options[selected].classList.add('wrong');
  }
  showNextBtn();
}

function checkFill() {
  if (quizState.answered) return;
  quizState.answered = true;
  const q = quizState.questions[quizState.current];
  const input = document.getElementById('fillInput');
  const userAnswer = input.value.trim().toLowerCase();
  const correct = q.answer.toLowerCase();
  const feedback = document.getElementById('quizFeedback');

  if (userAnswer === correct || correct.includes(userAnswer) && userAnswer.length > 4) {
    quizState.score++;
    input.className = 'fill-input correct';
    feedback.className = 'quiz-feedback show correct-fb';
    feedback.textContent = '‚úÖ Correct! ' + q.explanation;
  } else {
    input.className = 'fill-input wrong';
    feedback.className = 'quiz-feedback show wrong-fb';
    feedback.textContent = `‚ùå The answer is "${q.answer}". ${q.explanation}`;
  }
  input.disabled = true;
  showNextBtn();
}

function showNextBtn() {
  const area = document.getElementById('nextBtnArea');
  const isLast = quizState.current >= quizState.questions.length - 1;
  area.innerHTML = `<div class="btn-group" style="margin-top:16px">
    <button class="btn btn-primary" onclick="nextQuestion()">${isLast ? 'üèÜ See Results' : 'Next Question ‚Üí'}</button>
  </div>`;
}

function nextQuestion() {
  quizState.current++;
  quizState.answered = false;
  renderCurrentQuestion();
}

function renderQuizScore() {
  const total = quizState.questions.length;
  const score = quizState.score;
  const pct = Math.round((score / total) * 100);
  const messages = {
    0: "Don't worry ‚Äî every episode is a new chance! üí™",
    1: "Good start! Watch the episode again and try once more.",
    2: "Getting there! A few more reviews and you'll nail it.",
    3: "Nice work! Your slang game is developing.",
    4: "Really solid! You're picking up the Friends vocabulary.",
    5: "Great job! You understand the language well.",
    6: "Impressive! You've really absorbed this episode.",
    7: "Excellent! Your English is at a native-like level.",
    8: "Outstanding! You understand every nuance.",
    9: "Almost perfect! You could live in Monica's apartment.",
    10: "PERFECT! üéâ You ARE the WENUS. I'll see you on Monday.",
    11: "PERFECT! Ross would be proud. Even the villagers.",
    12: "FLAWLESS! Slap my ass and call me Judy ‚Äî you ACED it!",
  };
  const msg = messages[score] || messages[Math.min(score, 12)];

  document.getElementById('quizContainer').innerHTML = `
    <div class="quiz-score">
      <div class="score-number">${score}/${total}</div>
      <div class="score-label">Final Score ¬∑ ${pct}%</div>
      <div class="score-message">${msg}</div>
      <div class="btn-group" style="justify-content:center">
        <button class="btn btn-primary" onclick="startQuiz()">Try Again</button>
        <button class="btn btn-secondary" onclick="showSection('vocab')">Review Vocab</button>
      </div>
    </div>
  `;
}

// ==================== TABS ====================
function showSection(id) {
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  const tabs = ['vocab','dialogue','quiz','culture'];
  document.querySelectorAll('.tab-btn')[tabs.indexOf(id)].classList.add('active');
  if (id === 'quiz' && quizState.current === 0 && quizState.score === 0) startQuiz();
}

// ==================== INIT ====================
renderVocab();
renderDialogue();
renderCulture();
</script>
</body>
</html>
